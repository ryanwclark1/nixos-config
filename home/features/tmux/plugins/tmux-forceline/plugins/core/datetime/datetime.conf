# vim:set ft=tmux:
# DateTime Plugin for tmux-forceline
# Enhanced date and time display with timezone support

%hidden MODULE_NAME="datetime"

# Plugin metadata
set -g @_fl_plugin_datetime_version "2.0.0"
set -g @_fl_plugin_datetime_description "Enhanced date and time display with timezone support"

# DateTime display configuration
set -ogq @forceline_datetime_format "combined"      # date, time, combined, custom
set -ogq @forceline_datetime_separator " "          # Separator between date and time
set -ogq @forceline_datetime_date_format "%Y-%m-%d"
set -ogq @forceline_datetime_time_format "%H:%M"
set -ogq @forceline_datetime_timezone ""            # TZ identifier like "America/Los_Angeles"
set -ogq @forceline_datetime_locale ""              # Locale like "en_US.UTF-8"

# Base24 color configuration for datetime
set -ogq @forceline_datetime_fg "#{@fl_fg}"
set -ogq @forceline_datetime_bg "#{@fl_surface_0}"

# Plugin configuration using datetime format variables
set -ogq "@forceline_${MODULE_NAME}_icon" "ó°¥” "
set -ogq "@forceline_${MODULE_NAME}_color" "#{@fl_base0C}"  # cyan theme
set -ogq "@forceline_${MODULE_NAME}_text_fg" "#{@forceline_datetime_fg}"
set -ogq "@forceline_${MODULE_NAME}_text_bg" "#{@forceline_datetime_bg}"

# DateTime display format based on configuration
%if "#{==:#{@forceline_datetime_format},date}"
  set -ogq "@forceline_${MODULE_NAME}_text" " #{datetime_date}"
%elif "#{==:#{@forceline_datetime_format},time}"
  set -ogq "@forceline_${MODULE_NAME}_text" " #{datetime_time}"
%elif "#{==:#{@forceline_datetime_format},combined}"
  set -ogq "@forceline_${MODULE_NAME}_text" " #{datetime_date}#{@forceline_datetime_separator}#{datetime_time}"
%else
  # Custom format - user can define their own pattern using datetime variables
  set -ogq "@forceline_${MODULE_NAME}_text" " #{datetime_date}#{@forceline_datetime_separator}#{datetime_time}"
%endif

# Load the universal status module renderer
source -F "#{d:current_file}/../../utils/status_module.conf"

# Register plugin capabilities
set -ag @_fl_plugin_capabilities "datetime_display,timezone_support,locale_support,custom_formatting"