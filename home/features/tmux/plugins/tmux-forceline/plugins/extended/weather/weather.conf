# vim:set ft=tmux:
# Weather Plugin for tmux-forceline
# Weather information display with location and format options

%hidden MODULE_NAME="weather"

# Plugin metadata
set -g @_fl_plugin_weather_version "2.0.0"
set -g @_fl_plugin_weather_description "Weather information display with location and format options"

# Weather configuration
set -ogq @forceline_weather_location "New York"
set -ogq @forceline_weather_format "1"  # 1=icon+temp, 2=detailed, 3=icon only
set -ogq @forceline_weather_units "u"   # u=US units, m=metric
set -ogq @forceline_weather_interval "15"  # minutes between updates
set -ogq @forceline_weather_enabled "yes"

# Base24 color configuration
set -ogq @forceline_weather_fg "#{@fl_fg}"
set -ogq @forceline_weather_bg "#{@fl_surface_0}"

# Plugin configuration
set -ogq "@forceline_${MODULE_NAME}_icon" " "
set -ogq "@forceline_${MODULE_NAME}_color" "#{@fl_base0C}"  # cyan theme
set -ogq "@forceline_${MODULE_NAME}_text_fg" "#{@forceline_weather_fg}"
set -ogq "@forceline_${MODULE_NAME}_text_bg" "#{@forceline_weather_bg}"

# Weather display format using full absolute path
set -ogq "@forceline_${MODULE_NAME}_text" " #(/home/administrator/.config/tmux/plugins/tmux-forceline/modules/weather/scripts/weather.sh)"

# Load the universal status module renderer
source -F "#{d:current_file}/../../utils/status_module.conf"

# Register plugin capabilities
set -ag @_fl_plugin_capabilities "weather_monitoring,location_based,cached_updates"

# Set weather tmux options for the script
set -g @tmux-weather-location "#{@forceline_weather_location}"
set -g @tmux-weather-format "#{@forceline_weather_format}"
set -g @tmux-weather-units "#{@forceline_weather_units}"
set -g @tmux-weather-interval "#{@forceline_weather_interval}"