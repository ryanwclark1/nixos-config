# vim:set ft=tmux:
# Now Playing Plugin for tmux-forceline
# Cross-platform media player monitoring

%hidden MODULE_NAME="now_playing"

# Plugin metadata
set -g @_fl_plugin_now_playing_version "2.0.0"
set -g @_fl_plugin_now_playing_description "Cross-platform media player monitoring with format options"

# Now playing configuration
set -ogq @forceline_now_playing_max_len "30"
set -ogq @forceline_now_playing_truncate_symbol "…"
set -ogq @forceline_now_playing_show_player "no"
set -ogq @forceline_now_playing_enabled "yes"

# Base24 color configuration
set -ogq @forceline_now_playing_fg "#{@fl_fg}"
set -ogq @forceline_now_playing_bg "#{@fl_surface_0}"

# Plugin configuration
set -ogq "@forceline_${MODULE_NAME}_icon" "󰎈 "
set -ogq "@forceline_${MODULE_NAME}_color" "#{@fl_base0D}"  # blue theme
set -ogq "@forceline_${MODULE_NAME}_text_fg" "#{@forceline_now_playing_fg}"
set -ogq "@forceline_${MODULE_NAME}_text_bg" "#{@forceline_now_playing_bg}"

# Now playing display format using full absolute path
set -ogq "@forceline_${MODULE_NAME}_text" " #(/home/administrator/.config/tmux/plugins/tmux-forceline/modules/now_playing/now_playing.sh)"

# Load the universal status module renderer
source -F "#{d:current_file}/../../utils/status_module.conf"

# Register plugin capabilities
set -ag @_fl_plugin_capabilities "media_monitoring,spotify_support,apple_music_support,mpd_support"